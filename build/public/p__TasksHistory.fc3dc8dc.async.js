(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{"3xD1":function(e,t,a){"use strict";var s=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(a("plSh")),l=s(a("q1tI")),r=function(){return l.default.createElement(n.default,null)};t.default=r},NkVC:function(e,t,a){"use strict";var s=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,a("cWXX");var n=s(a("/ezw")),l=s(a("q1tI"));function r(){return l.default.createElement("div",{style:{padding:"0 24px"}},l.default.createElement(n.default,{title:!1,active:!0,paragraph:{width:"100%",rows:6}}))}},a0Ys:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetTasks=n,t.refreshTasks=l,t.refreshTasksSuccess=r,t.refreshTasksFail=i;var s=a("zcGw");function n(){return{type:s.RESET_TASKS}}function l(){return{type:s.REFRESH_TASKS}}function r(e){return{type:s.REFRESH_TASKS_SUCCESS,total:e.total,tasks:e.tasks,nextCursor:e.nextCursor,previousCursor:e.previousCursor}}function i(e){return{type:s.REFRESH_TASKS_FAIL,error:e}}},plSh:function(e,t,a){"use strict";var s=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.TasksHistory=void 0,a("g9YV");var n=s(a("wCAj"));a("14J3");var l=s(a("BMrR"));a("qVdP");var r=s(a("jsC+"));a("jCWc");var i=s(a("kPKH"));a("5Dmo");var o=s(a("3S7+"));a("Pwec");var u=s(a("CtXQ"));a("lUTK");var d=s(a("BvKs"));a("R9oj");var c=s(a("ECub")),f=s(a("p0pE")),p=s(a("d6i3"));a("miYZ");var m=s(a("tsqr")),h=s(a("1l/V"));a("sRBo");var g=s(a("kaz8"));a("+L6B");var v=s(a("2/Rp"));a("5NDa");var k=s(a("5rEg")),E=s(a("2Taf")),S=s(a("vZ4D")),y=s(a("MhPg")),T=s(a("l4Ni")),w=s(a("ujKo"));a("T2oS");var b=s(a("W9HT")),R=s(a("fFZ8")),C=a("Y2fQ"),M=a("Hx5s"),A=s(a("EVdn")),F=s(a("s/Ur")),H=s(a("q1tI")),D=s(a("LlRK")),x=s(a("LvDl")),K=a("MuoO"),_=s(a("Wgwc")),I=s(a("vOnD")),P=s(a("NkVC")),B=a("a0Ys"),N=a("MOfv"),z=s(a("IE/S")),L=s(a("js9m"));function V(e){var t=O();return function(){var a,s=(0,w.default)(e);if(t){var n=(0,w.default)(this).constructor;a=Reflect.construct(s,arguments,n)}else a=s.apply(this,arguments);return(0,T.default)(this,a)}}function O(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function U(){var e=(0,R.default)(["\n  padding: 100px 0;\n"]);return U=function(){return e},e}var j=I.default.div(U()),Y=H.default.createElement("div",{style:{textAlign:"center",paddingTop:10,paddingBottom:10}},H.default.createElement(b.default,null)),W=function(e){(0,y.default)(a,e);var t=V(a);function a(e){var s;return(0,E.default)(this,a),s=t.call(this,e),s.search=function(){s.setState({selectedRowKeys:[],selectedRows:[]}),s.props.dispatch((0,B.resetTasks)()),s.loadMoreTasks(null)},s.handleReset=function(e,t){e(),s.setState({searchText:""}),delete s.filterConditions[t],s.search()},s.handleSearch=function(e,t,a){t(),s.setState({searchText:e}),s.filterConditions[a]=e,s.search()},s.getColumnSearchProps=function(e){return{filterDropdown:function(t){var a=t.setSelectedKeys,n=t.selectedKeys,l=t.confirm,r=t.clearFilters;return H.default.createElement("div",{style:{padding:8}},H.default.createElement(k.default,{ref:function(e){s.searchInput=e},placeholder:"Search ".concat(e),value:n[0],onChange:function(e){return a(e.target.value?[e.target.value]:[])},onPressEnter:function(){return s.handleSearch(n,l,e)},style:{width:250,marginBottom:8,display:"block"}}),H.default.createElement(v.default,{type:"primary",onClick:function(){return s.handleSearch(n&&n[0],l,e)},size:"small",style:{width:90,marginRight:8}},H.default.createElement(C.FormattedMessage,{id:"app.common.messages.search"})),H.default.createElement(v.default,{onClick:function(){return s.handleReset(r,e)},size:"small",style:{width:90}},H.default.createElement(C.FormattedMessage,{id:"app.common.messages.reset"})))},onFilterDropdownVisibleChange:function(e){e&&setTimeout(function(){return s.searchInput.select()})}}},s.getColumnCheckboxProps=function(e,t){return{filterDropdown:function(a){var n=a.setSelectedKeys,l=a.selectedKeys,r=a.confirm,i=a.clearFilters;return H.default.createElement("div",{style:{padding:8},className:"tasks-checkboxgroup"},H.default.createElement(g.default.Group,{options:t,defaultValue:l,onChange:function(t){s.filterConditions[e]=t,n(t)}}),H.default.createElement("div",null,H.default.createElement(v.default,{type:"primary",onClick:function(){return s.handleSearch(l,r,e)},size:"small",style:{width:90,marginRight:8}},H.default.createElement(C.FormattedMessage,{id:"app.common.messages.search"})),H.default.createElement(v.default,{onClick:function(){return s.handleReset(i,e)},size:"small",style:{width:90}},H.default.createElement(C.FormattedMessage,{id:"app.common.messages.reset"}))))}}},s.props.dispatch((0,B.resetTasks)()),s.state={selectedRowKeys:[],selectedRows:[],loadingMore:!1,loadingTasksData:!0,drawerVisiable:!1,selectedTask:void 0,contentHeight:window.innerHeight,operationBtns:{pausing:!1,resuming:!1,deleting:!1}},s.filterConditions={},s.lastScrollHeight=0,s.resizeTimeoutHandler=void 0,(0,A.default)(window).unbind("resize"),(0,A.default)(window).bind("resize",function(){clearTimeout(s.resizeTimeoutHandler),s.resizeTimeoutHandler=setTimeout(function(){s.setState({contentHeight:window.innerHeight})},500)}),s}return(0,S.default)(a,[{key:"componentDidUpdate",value:function(){var e=this;(0,A.default)(".task-table-container .ant-table-body").unbind("scroll"),(0,A.default)(".task-table-container .ant-table-body").bind("scroll",function(){var t=(0,A.default)(".task-table-container .ant-table-body").scrollTop(),a=(0,A.default)(".task-table-container .ant-table-body").outerHeight(),s=document.querySelector(".task-table-container .ant-table-body"),n=s.scrollHeight;n-t-a<200&&e.props.tasks.nextCursor&&(e.state.loadingMore||(e.lastScrollHeight=n,e.loadMoreTasks()))})}},{key:"componentWillUnmount",value:function(){(0,A.default)(window).unbind("resize")}},{key:"componentDidMount",value:function(){this.initTasksData()}},{key:"onShowDrawer",value:function(e){this.setState({drawerVisiable:!0,selectedTask:e})}},{key:"onCloseDrawer",value:function(){this.setState({drawerVisiable:!1,selectedTask:void 0})}},{key:"onDeleteAll",value:function(){var e=(0,h.default)(p.default.mark(function e(){var t;return p.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.state.selectedRows&&this.state.selectedRows.length&&(t=this.state.selectedRows.map(function(e){return e.globalId})),this.setState({operationBtns:{pausing:!1,deleting:!0,resuming:!1}}),e.next=5,(0,N.deleteTasksOrHistoryForManagementAPI)(this.filterConditions.url,t,this.filterConditions.state,!0);case 5:m.default.success((0,C.formatMessage)({id:"app.containers.Tasks.deleteAllSuccessful"})),this.setState({operationBtns:{pausing:!1,deleting:!1,resuming:!1}}),this.initTasksData(),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),this.setState({operationBtns:{pausing:!1,deleting:!1,resuming:!1}});case 13:case"end":return e.stop()}},e,this,[[0,10]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"onRerunAll",value:function(){var e=(0,h.default)(p.default.mark(function e(){var t,a;return p.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.state.selectedRows&&this.state.selectedRows.length&&(t=this.state.selectedRows.map(function(e){return e.globalId})),this.setState({operationBtns:{pausing:!1,deleting:!1,resuming:!1,reruning:!0}}),e.next=5,(0,N.rerunTasksForManagementAPI)(this.filterConditions.url,t,this.filterConditions.state);case 5:a=(0,C.formatMessage)({id:"app.containers.TasksHistory.rerunAllSuccess"}),m.default.success(a),this.setState({operationBtns:{pausing:!1,deleting:!1,resuming:!1,reruning:!1}}),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),this.setState({operationBtns:{pausing:!1,deleting:!1,resuming:!1,reruning:!1}});case 13:case"end":return e.stop()}},e,this,[[0,10]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"initTasksData",value:function(){var e=this;this.props.dispatch((0,B.resetTasks)()),this.setState({loadingTasksData:!0,selectedRowKeys:[],selectedRows:[]}),(0,N.getTasksOrHistoryForManagementAPI)(void 0,this.filterConditions.url,this.filterConditions.state,50,!0).then(function(t){e.setState({loadingTasksData:!1}),e.props.dispatch((0,B.refreshTasksSuccess)(t))},function(t){e.setState({loadingTasksData:!1}),e.props.dispatch((0,B.refreshTasksFail)(t))})}},{key:"loadMoreTasks",value:function(e){var t=this;this.setState({loadingMore:!0}),void 0===e&&(e=this.props.tasks.nextCursor),(0,N.getTasksOrHistoryForManagementAPI)(e,this.filterConditions.url,this.filterConditions.state,50,!0).then(function(e){t.props.dispatch((0,B.refreshTasksSuccess)(e)),t.setState({loadingMore:!1})},function(e){t.props.dispatch((0,B.refreshTasksFail)(e)),t.setState({loadingMore:!1})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.loadingTasksData,s=t.contentHeight,p=t.loadingMore,m=t.drawerVisiable,h=t.selectedTask,g=this.props.tasks,k=H.default.createElement(P.default,null),E=[(0,f.default)({title:"Target URL",dataIndex:"url",filteredValue:this.filterConditions.url},this.getColumnSearchProps("url")),(0,f.default)({title:(0,C.formatMessage)({id:"app.common.messages.state"}),dataIndex:"system.state",render:function(e){return H.default.createElement(z.default,{state:e})},filteredValue:this.filterConditions.state},this.getColumnCheckboxProps("state",[{label:(0,C.formatMessage)({id:"app.common.messages.stateDraft"}),value:"DRAFT"},{label:(0,C.formatMessage)({id:"app.common.messages.stateConfigured"}),value:"CONFIGURED"},{label:(0,C.formatMessage)({id:"app.common.messages.stateFinished"}),value:"FINISHED"},{label:(0,C.formatMessage)({id:"app.common.messages.stateRunning"}),value:"RUNNING"},{label:(0,C.formatMessage)({id:"app.common.messages.stateFailed"}),value:"FAILED"},{label:(0,C.formatMessage)({id:"app.common.messages.statePaused"}),value:"PAUSED"},{label:(0,C.formatMessage)({id:"app.common.messages.stateTimeout"}),value:"TIMEOUT"}])),{title:"Last Modified At",dataIndex:"system.modified",render:function(e){return(0,_.default)(e).format("YYYY/MM/DD HH:mm:ss")}}],S={selectedRowKeys:this.state.selectedRowKeys,onChange:function(t,a){e.setState({selectedRowKeys:t,selectedRows:a})}};if(!a)if(g.data&&g.data.length||x.default.keys(this.filterConditions).length){var y=g&&g.total||0;this.state.selectedRows&&this.state.selectedRows.length&&(y=this.state.selectedRows.length);var T=!1;(this.state.operationBtns.pausing||this.state.operationBtns.resuming||this.state.operationBtns.deleting)&&(T=!0),y&&!a||(T=!0);var w=H.default.createElement(d.default,null,H.default.createElement(d.default.Item,null,H.default.createElement(v.default,{type:"link",onClick:function(){e.onRerunAll()},disabled:T,loading:this.state.operationBtns.reruning},H.default.createElement(C.FormattedMessage,{id:"app.containers.TasksHistory.rerunAll",values:{taskNumber:y}}))),H.default.createElement(d.default.Item,null,H.default.createElement(v.default,{type:"link",onClick:function(){e.onDeleteAll()},disabled:T,loading:this.state.operationBtns.deleting},H.default.createElement(C.FormattedMessage,{id:"app.containers.Tasks.deleteAll",values:{taskNumber:y}})))),b=H.default.createElement("div",{style:{display:"inline-block"}},H.default.createElement("div",{style:{display:"inline-block"}},H.default.createElement("span",null,H.default.createElement(C.FormattedMessage,{id:"app.containers.Tasks.showTasks",values:{tasksNumber:x.default.get(g,"data.length"),tasksTotal:g.total}}))),H.default.createElement(v.default,{type:"link",onClick:function(){return e.initTasksData()},disabled:a},H.default.createElement(D.default,{date:g.modified}),H.default.createElement(u.default,{type:"sync",style:{verticalAlign:"middle",marginLeft:"5px"},spin:a})));k=H.default.createElement("div",{className:"task-table-container"},H.default.createElement("div",null,H.default.createElement("div",{style:{paddingBottom:"15px"}},H.default.createElement(l.default,null,H.default.createElement(F.default,{minWidth:1028},H.default.createElement(i.default,{span:16},H.default.createElement(o.default,{title:H.default.createElement(C.FormattedHTMLMessage,{id:"app.containers.TasksHistory.rerunAllHint",values:{taskNumber:y}})},H.default.createElement(v.default,{onClick:function(){e.onRerunAll()},style:{marginLeft:"10px"},disabled:T,loading:this.state.operationBtns.reruning},H.default.createElement(C.FormattedMessage,{id:"app.containers.TasksHistory.rerunAll",values:{taskNumber:y}}))),H.default.createElement(v.default,{onClick:function(){e.onDeleteAll()},style:{marginLeft:"10px"},disabled:T,loading:this.state.operationBtns.deleting},H.default.createElement(C.FormattedMessage,{id:"app.containers.Tasks.deleteAll",values:{taskNumber:y}}))),H.default.createElement(i.default,{span:8,style:{textAlign:"right"}},b)),H.default.createElement(F.default,{maxWidth:1028},H.default.createElement(i.default,{span:3},H.default.createElement(r.default,{overlay:w},H.default.createElement(v.default,null,H.default.createElement(u.default,{type:"menu"})))),H.default.createElement(i.default,{span:21,style:{textAlign:"right"}},b)))),H.default.createElement(n.default,{className:"",pagination:!1,bordered:!0,columns:E,rowSelection:S,dataSource:g.data,rowKey:function(e){return e.globalId},scroll:{y:s-310},onRow:function(t){return{onClick:function(){e.onShowDrawer(t)}}}}),p?Y:""))}else k=H.default.createElement(j,null,H.default.createElement(c.default,{description:H.default.createElement("span",null,H.default.createElement(C.FormattedHTMLMessage,{id:"app.containers.TasksHistory.empty"}))}));return H.default.createElement("div",{style:{padding:"20px"}},H.default.createElement(M.PageHeaderWrapper,null,k,H.default.createElement(L.default,{visiable:m,onCloseDrawer:function(){e.onCloseDrawer()},task:h})))}}],[{key:"onPreventShowDrawer",value:function(e){e.preventDefault(),e.stopPropagation()}}]),a}(H.default.Component);t.TasksHistory=W;var q=(0,K.connect)(function(e){var t=e.tasks;return{tasks:t}})(W);t.default=q},zcGw:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.REFRESH_TASKS_FAIL=t.REFRESH_TASKS_SUCCESS=t.REFRESH_TASKS=t.RESET_TASKS=void 0;var s="tasks/resetTasks";t.RESET_TASKS=s;var n="tasks/refreshTasks";t.REFRESH_TASKS=n;var l="tasks/refreshTasksSuccess";t.REFRESH_TASKS_SUCCESS=l;var r="tasks/refreshTasksFail";t.REFRESH_TASKS_FAIL=r}}]);