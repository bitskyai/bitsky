(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{AmQH:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetTasks=n,t.refreshTasks=l,t.refreshTasksSuccess=r,t.refreshTasksFail=i;var s=a("wsQp");function n(){return{type:s.RESET_TASKS}}function l(){return{type:s.REFRESH_TASKS}}function r(e){return{type:s.REFRESH_TASKS_SUCCESS,total:e.total,tasks:e.tasks,nextCursor:e.nextCursor,previousCursor:e.previousCursor}}function i(e){return{type:s.REFRESH_TASKS_FAIL,error:e}}},Xktj:function(e,t,a){"use strict";var s=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(a("wMY7")),l=s(a("q1tI")),r=function(){return l.default.createElement(n.default,null)};t.default=r},"ml+r":function(e,t,a){"use strict";var s=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,a("cWXX");var n=s(a("/ezw")),l=s(a("q1tI"));function r(){return l.default.createElement("div",{style:{padding:"0 24px"}},l.default.createElement(n.default,{title:!1,active:!0,paragraph:{width:"100%",rows:6}}))}},wMY7:function(e,t,a){"use strict";var s=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Tasks=void 0,a("g9YV");var n=s(a("wCAj"));a("14J3");var l=s(a("BMrR"));a("qVdP");var r=s(a("jsC+"));a("jCWc");var i=s(a("kPKH"));a("Pwec");var o=s(a("CtXQ"));a("lUTK");var u=s(a("BvKs"));a("5Dmo");var d=s(a("3S7+"));a("R9oj");var c=s(a("ECub")),f=s(a("p0pE"));a("miYZ");var m=s(a("tsqr")),p=s(a("d6i3")),g=s(a("1l/V"));a("sRBo");var h=s(a("kaz8"));a("+L6B");var k=s(a("2/Rp"));a("5NDa");var v=s(a("5rEg")),E=s(a("2Taf")),T=s(a("vZ4D")),S=s(a("MhPg")),y=s(a("l4Ni")),w=s(a("ujKo"));a("T2oS");var b=s(a("W9HT")),R=s(a("fFZ8")),M=a("Y2fQ"),C=a("Hx5s"),A=s(a("EVdn")),F=s(a("s/Ur")),H=s(a("q1tI")),D=s(a("LlRK")),x=s(a("LvDl")),I=a("MuoO"),K=s(a("Wgwc")),P=s(a("vOnD")),_=s(a("ml+r")),B=a("AmQH"),N=a("MOfv"),L=s(a("IE/S")),O=a("ydnR"),j=s(a("js9m"));function z(e){var t=U();return function(){var a,s=(0,w.default)(e);if(t){var n=(0,w.default)(this).constructor;a=Reflect.construct(s,arguments,n)}else a=s.apply(this,arguments);return(0,y.default)(this,a)}}function U(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function V(){var e=(0,R.default)(["\n  padding: 100px 0;\n"]);return V=function(){return e},e}var Y=P.default.div(V()),W=H.default.createElement("div",{style:{textAlign:"center",paddingTop:10,paddingBottom:10}},H.default.createElement(b.default,null)),q=function(e){(0,S.default)(a,e);var t=z(a);function a(e){var s;return(0,E.default)(this,a),s=t.call(this,e),s.search=function(){s.setState({selectedRowKeys:[],selectedRows:[]}),s.props.dispatch((0,B.resetTasks)()),s.loadMoreTasks(null)},s.getColumnSearchProps=function(e){return{filterDropdown:function(t){var a=t.setSelectedKeys,n=t.selectedKeys,l=t.confirm,r=t.clearFilters;return H.default.createElement("div",{style:{padding:8}},H.default.createElement(v.default,{ref:function(e){s.searchInput=e},placeholder:"Search ".concat(e),value:n[0],onChange:function(e){return a(e.target.value?[e.target.value]:[])},onPressEnter:function(){return s.handleSearch(n,l,e)},style:{width:250,marginBottom:8,display:"block"}}),H.default.createElement(k.default,{type:"primary",onClick:function(){return s.handleSearch(n&&n[0],l,e)},size:"small",style:{width:90,marginRight:8}},H.default.createElement(M.FormattedMessage,{id:"app.common.messages.search"})),H.default.createElement(k.default,{onClick:function(){return s.handleReset(r,e)},size:"small",style:{width:90}},H.default.createElement(M.FormattedMessage,{id:"app.common.messages.reset"})))},onFilterDropdownVisibleChange:function(e){e&&setTimeout(function(){return s.searchInput.select()})}}},s.getColumnCheckboxProps=function(e,t){return{filterDropdown:function(a){var n=a.setSelectedKeys,l=a.selectedKeys,r=a.confirm,i=a.clearFilters;return H.default.createElement("div",{style:{padding:8},className:"tasks-checkboxgroup"},H.default.createElement(h.default.Group,{options:t,defaultValue:l,onChange:function(t){s.filterConditions[e]=t,n(t)}}),H.default.createElement("div",null,H.default.createElement(k.default,{type:"primary",onClick:function(){return s.handleSearch(l,r,e)},size:"small",style:{width:90,marginRight:8}},H.default.createElement(M.FormattedMessage,{id:"app.common.messages.search"})),H.default.createElement(k.default,{onClick:function(){return s.handleReset(i,e)},size:"small",style:{width:90}},H.default.createElement(M.FormattedMessage,{id:"app.common.messages.reset"}))))}}},s.handleSearch=function(e,t,a){t(),s.setState({searchText:e}),s.filterConditions[a]=e,s.search()},s.handleReset=function(e,t){e(),s.setState({searchText:""}),delete s.filterConditions[t],s.search()},s.props.dispatch((0,B.resetTasks)()),s.state={selectedRowKeys:[],selectedRows:[],loadingMore:!1,loadingTasksData:!0,contentHeight:window.innerHeight,drawerVisiable:!1,selectedTask:void 0,operationBtns:{pausing:!1,resuming:!1,deleting:!1}},s.filterConditions={},s.lastScrollHeight=0,s.resizeTimeoutHandler=void 0,(0,A.default)(window).unbind("resize"),(0,A.default)(window).bind("resize",function(){clearTimeout(s.resizeTimeoutHandler),s.resizeTimeoutHandler=setTimeout(function(){s.setState({contentHeight:window.innerHeight})},500)}),s}return(0,T.default)(a,[{key:"componentDidMount",value:function(){this.initTasksData()}},{key:"componentDidUpdate",value:function(){var e=this;(0,A.default)(".task-table-container .ant-table-body").unbind("scroll"),(0,A.default)(".task-table-container .ant-table-body").bind("scroll",function(){var t=(0,A.default)(".task-table-container .ant-table-body").scrollTop(),a=(0,A.default)(".task-table-container .ant-table-body").outerHeight(),s=document.querySelector(".task-table-container .ant-table-body"),n=s.scrollHeight;n-t-a<200&&e.props.tasks.nextCursor&&(e.state.loadingMore||(e.lastScrollHeight=n,e.loadMoreTasks()))})}},{key:"componentWillUnmount",value:function(){(0,A.default)(window).unbind("resize")}},{key:"onShowDrawer",value:function(e){this.setState({drawerVisiable:!0,selectedTask:e})}},{key:"onCloseDrawer",value:function(){this.setState({drawerVisiable:!1,selectedTask:void 0})}},{key:"onPauseAll",value:function(){var e=(0,g.default)(p.default.mark(function e(){var t;return p.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.state.selectedRows&&this.state.selectedRows.length&&(t=this.state.selectedRows.map(function(e){return e.globalId})),this.setState({operationBtns:{pausing:!0,deleting:!1,resuming:!1}}),e.next=5,(0,N.pauseTasksForManagementAPI)(this.filterConditions.url,t,this.filterConditions.state);case 5:this.setState({operationBtns:{pausing:!1,deleting:!1,resuming:!1}}),this.initTasksData(),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),this.setState({operationBtns:{pausing:!1,deleting:!1,resuming:!1}});case 12:case"end":return e.stop()}},e,this,[[0,9]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"onResumeAll",value:function(){var e=(0,g.default)(p.default.mark(function e(){var t;return p.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.state.selectedRows&&this.state.selectedRows.length&&(t=this.state.selectedRows.map(function(e){return e.globalId})),this.setState({operationBtns:{pausing:!1,deleting:!1,resuming:!0}}),e.next=5,(0,N.resumeTasksForManagementAPI)(this.filterConditions.url,t,this.filterConditions.state);case 5:this.setState({operationBtns:{pausing:!1,deleting:!1,resuming:!1}}),this.initTasksData(),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),this.setState({operationBtns:{pausing:!1,deleting:!1,resuming:!1}});case 12:case"end":return e.stop()}},e,this,[[0,9]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"onDeleteAll",value:function(){var e=(0,g.default)(p.default.mark(function e(){var t;return p.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.state.selectedRows&&this.state.selectedRows.length&&(t=this.state.selectedRows.map(function(e){return e.globalId})),this.setState({operationBtns:{pausing:!1,deleting:!0,resuming:!1}}),e.next=5,(0,N.deleteTasksOrHistoryForManagementAPI)(this.filterConditions.url,t,this.filterConditions.state);case 5:m.default.success((0,M.formatMessage)({id:"app.containers.Tasks.deleteAllSuccessful"})),this.setState({operationBtns:{pausing:!1,deleting:!1,resuming:!1}}),this.initTasksData(),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),this.setState({operationBtns:{pausing:!1,deleting:!1,resuming:!1}});case 13:case"end":return e.stop()}},e,this,[[0,10]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"loadMoreTasks",value:function(e){var t=this;this.setState({loadingMore:!0}),void 0===e&&(e=this.props.tasks.nextCursor),(0,N.getTasksOrHistoryForManagementAPI)(e,this.filterConditions.url,this.filterConditions.state).then(function(e){t.props.dispatch((0,B.refreshTasksSuccess)(e)),t.setState({loadingMore:!1})},function(e){t.props.dispatch((0,B.refreshTasksFail)(e)),t.setState({loadingMore:!1})})}},{key:"initTasksData",value:function(){var e=this;this.props.dispatch((0,B.resetTasks)()),this.setState({loadingTasksData:!0,selectedRowKeys:[],selectedRows:[]}),(0,N.getTasksOrHistoryForManagementAPI)(void 0,this.filterConditions.url,this.filterConditions.state).then(function(t){e.setState({loadingTasksData:!1}),e.props.dispatch((0,B.refreshTasksSuccess)(t))},function(t){e.setState({loadingTasksData:!1}),e.props.dispatch((0,B.refreshTasksFail)(t))})}},{key:"render",value:function(){var e=this,t=this.state,a=t.loadingTasksData,s=t.contentHeight,m=t.loadingMore,p=t.drawerVisiable,g=t.selectedTask,h=this.props.tasks,v=H.default.createElement(_.default,null),E=[(0,f.default)({title:"Target URL",dataIndex:"url",filteredValue:this.filterConditions.url},this.getColumnSearchProps("url")),(0,f.default)({title:(0,M.formatMessage)({id:"app.common.messages.state"}),dataIndex:"system.state",render:function(e){return H.default.createElement(L.default,{state:e})},filteredValue:this.filterConditions.state},this.getColumnCheckboxProps("state",[{label:(0,M.formatMessage)({id:"app.common.messages.stateDraft"}),value:"DRAFT"},{label:(0,M.formatMessage)({id:"app.common.messages.stateConfigured"}),value:"CONFIGURED"},{label:(0,M.formatMessage)({id:"app.common.messages.stateFinished"}),value:"FINISHED"},{label:(0,M.formatMessage)({id:"app.common.messages.stateRunning"}),value:"RUNNING"},{label:(0,M.formatMessage)({id:"app.common.messages.stateFailed"}),value:"FAILED"},{label:(0,M.formatMessage)({id:"app.common.messages.statePaused"}),value:"PAUSED"},{label:(0,M.formatMessage)({id:"app.common.messages.stateTimeout"}),value:"TIMEOUT"}])),{title:(0,M.formatMessage)({id:"app.common.messages.retailerState"}),dataIndex:"retailer.state",render:function(e){var t=e;return t===O.STATES.failed?t=O.STATES.lostConnection:t===O.STATES.active&&(t=O.STATES.connected),H.default.createElement(L.default,{state:t})}},{title:"Last Modified At",dataIndex:"system.modified",render:function(e){return(0,K.default)(e).format("YYYY/MM/DD HH:mm:ss")}}],T={selectedRowKeys:this.state.selectedRowKeys,onChange:function(t,a){e.setState({selectedRowKeys:t,selectedRows:a})}};if(!a)if(h.data&&h.data.length||x.default.keys(this.filterConditions).length){var S=h&&h.total||0;this.state.selectedRows&&this.state.selectedRows.length&&(S=this.state.selectedRows.length);var y=!1;(this.state.operationBtns.pausing||this.state.operationBtns.resuming||this.state.operationBtns.deleting)&&(y=!0),S&&!a||(y=!0);var w=H.default.createElement(u.default,null,H.default.createElement(u.default.Item,null,H.default.createElement(d.default,{title:H.default.createElement(M.FormattedHTMLMessage,{id:"app.containers.Tasks.pauseAllHint",values:{taskNumber:S}})},H.default.createElement(k.default,{type:"link",onClick:function(){e.onPauseAll()},disabled:y,loading:this.state.operationBtns.pausing},H.default.createElement(M.FormattedMessage,{id:"app.containers.Tasks.pauseAll",values:{taskNumber:S}})))),H.default.createElement(u.default.Item,null,H.default.createElement(d.default,{title:H.default.createElement(M.FormattedHTMLMessage,{id:"app.containers.Tasks.resumeAllHint",values:{taskNumber:S}})},H.default.createElement(k.default,{type:"link",onClick:function(){e.onResumeAll()},disabled:y,loading:this.state.operationBtns.resuming},H.default.createElement(M.FormattedMessage,{id:"app.containers.Tasks.resumeAll",values:{taskNumber:S}})))),H.default.createElement(u.default.Item,null,H.default.createElement(d.default,{title:H.default.createElement(M.FormattedHTMLMessage,{id:"app.containers.Tasks.deleteAllHint",values:{taskNumber:S}})},H.default.createElement(k.default,{type:"link",onClick:function(){e.onDeleteAll()},disabled:y,loading:this.state.operationBtns.deleting},H.default.createElement(M.FormattedMessage,{id:"app.containers.Tasks.deleteAll",values:{taskNumber:S}}))))),b=H.default.createElement("div",{style:{display:"inline-block"}},H.default.createElement("div",{style:{display:"inline-block"}},H.default.createElement("span",null,H.default.createElement(M.FormattedMessage,{id:"app.containers.Tasks.showTasks",values:{tasksNumber:x.default.get(h,"data.length"),tasksTotal:h.total}}))),H.default.createElement(k.default,{type:"link",onClick:function(){return e.initTasksData()},disabled:a},H.default.createElement(D.default,{date:h.modified}),H.default.createElement(o.default,{type:"sync",style:{verticalAlign:"middle",marginLeft:"5px"},spin:a})));v=H.default.createElement("div",{className:"task-table-container"},H.default.createElement("div",null,H.default.createElement("div",{style:{paddingBottom:"15px"}},H.default.createElement(l.default,null,H.default.createElement(F.default,{minWidth:1024},H.default.createElement(i.default,{span:14},H.default.createElement(d.default,{title:H.default.createElement(M.FormattedHTMLMessage,{id:"app.containers.Tasks.pauseAllHint",values:{taskNumber:S}})},H.default.createElement(k.default,{onClick:function(){e.onPauseAll()},disabled:y,loading:this.state.operationBtns.pausing},H.default.createElement(M.FormattedMessage,{id:"app.containers.Tasks.pauseAll",values:{taskNumber:S}}))),H.default.createElement(d.default,{title:H.default.createElement(M.FormattedHTMLMessage,{id:"app.containers.Tasks.resumeAllHint",values:{taskNumber:S}})},H.default.createElement(k.default,{onClick:function(){e.onResumeAll()},style:{marginLeft:"10px"},disabled:y,loading:this.state.operationBtns.resuming},H.default.createElement(M.FormattedMessage,{id:"app.containers.Tasks.resumeAll",values:{taskNumber:S}}))),H.default.createElement(d.default,{title:H.default.createElement(M.FormattedHTMLMessage,{id:"app.containers.Tasks.deleteAllHint",values:{taskNumber:S}})},H.default.createElement(k.default,{onClick:function(){e.onDeleteAll()},style:{marginLeft:"10px"},disabled:y,loading:this.state.operationBtns.deleting},H.default.createElement(M.FormattedMessage,{id:"app.containers.Tasks.deleteAll",values:{taskNumber:S}})))),H.default.createElement(i.default,{span:10,style:{textAlign:"right"}},b)),H.default.createElement(F.default,{maxWidth:1024},H.default.createElement(i.default,{span:3},H.default.createElement(r.default,{overlay:w},H.default.createElement(k.default,null,H.default.createElement(o.default,{type:"menu"})))),H.default.createElement(i.default,{span:21,style:{textAlign:"right"}},b)))),H.default.createElement(n.default,{className:"",pagination:!1,bordered:!0,columns:E,rowSelection:T,dataSource:h.data,rowKey:function(e){return e.globalId},scroll:{y:s-310},onRow:function(t){return{onClick:function(){e.onShowDrawer(t)}}}}),m?W:""))}else v=H.default.createElement(Y,null,H.default.createElement(c.default,{description:H.default.createElement("span",null,H.default.createElement(M.FormattedHTMLMessage,{id:"app.containers.Tasks.emptyTasks"}))}));return H.default.createElement("div",{style:{padding:"20px"}},H.default.createElement(C.PageHeaderWrapper,null,v,H.default.createElement(j.default,{visiable:p,onCloseDrawer:function(){e.onCloseDrawer()},task:g})))}}],[{key:"onPreventShowDrawer",value:function(e){e.preventDefault(),e.stopPropagation()}}]),a}(H.default.Component);t.Tasks=q;var Q=(0,I.connect)(function(e){var t=e.tasks;return{tasks:t}})(q);t.default=Q},wsQp:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.REFRESH_TASKS_FAIL=t.REFRESH_TASKS_SUCCESS=t.REFRESH_TASKS=t.RESET_TASKS=void 0;var s="tasks/resetTasks";t.RESET_TASKS=s;var n="tasks/refreshTasks";t.REFRESH_TASKS=n;var l="tasks/refreshTasksSuccess";t.REFRESH_TASKS_SUCCESS=l;var r="tasks/refreshTasksFail";t.REFRESH_TASKS_FAIL=r}}]);